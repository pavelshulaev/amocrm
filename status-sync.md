# Синхронизация статусов заказов в магазине и сделок в amoCRM [с версии 2.2]

Решение позволяет настроить двустороннюю синхронизацию статусов заказов в интернет-магазине и статусов сделок в амоЦРМ.

## Общие настройки
![Обновление решений](./status-sync/sync-common.png)

Для корректной работы синхронизации статсов необходимо:
1. Выбрать поле заказа, которое будет использовано в качестве его уникального идентификатора
2. Указать кастомное поле сделки, в которое передаётся уникальный иденитификатор заказа.
3. Настроить маппинг статусов заказа и статусо сделки.

> Обратите внимание, настройки в пунктах 1. и 2. только указывают решению, в каком поле сделки искать уникальный идентификатор заказа. Передачу уникального идентификатора заказа в это поле сделки необходимо настроить отдельно в соотвествующем правиле интеграции (например, "Новый заказ", "Заказ оплачен" и т.д.).

## Настройка синхронзации статусов заказов интернет-магазина со статусами сделки в амоCRM
Для корректной синхронизации достаточно произвести все настройки из пункта "Общие настройки" и отметить галочку "интернет-магазин > amoCRM".

![Обновление решений](./status-sync/sync-bx-amo.png)

> Обратите внимание, что из-за системных ограничений со стороны amoCRM синхронизация возможна только для тех заказов, чьи уникальные идентификтаоры содержат не менее трёх символов.

## Настройка синхронзации статусов заказов интернет-магазина со статусами сделки в амоCRM
Для корректной синхронизации достаточно произвести все настройки из пункта "Общие настройки", отметить галочку "amoCRM > интернет-магазин", а так же добавить со стороны amoCRM вебхук на адрес, указанный в пункте "URL для вебхука" и настроить его срабатывание на событие "Статус сделки изменен" или "При переходе в этап" для сделки.

![Обновление решений](./status-sync/sync-amo-bx.png)

> [Подробнее про добавление вебхуков](https://www.amocrm.ru/developers/content/api/webhooks)
---
[на главную](./README.MD)    